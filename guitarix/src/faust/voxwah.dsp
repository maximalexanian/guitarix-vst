// generated automatically
// DO NOT MODIFY!
declare id "voxwah";
declare name "Vox Wah V847";
declare category "Guitar Effects";
declare shortname "Vox Wah";
declare description "Vox Wah V847";

import("stdfaust.lib");
import("guitarix.lib");

process(x) = x : _<:*(dry),(*(wet) : pre : fi.iir((b0/a0,b1/a0,b2/a0,b3/a0,b4/a0),(a1/a0,a2/a0,a3/a0,a4/a0))):>_ with {
    LogPot(a, x) = ba.if(a, (exp(a * x) - 1) / (exp(a) - 1), x);
    Inverted(b, x) = ba.if(b, 1 - x, x);
    s = 0.993;
    fs = float(ma.SR);
    pre = fi.dcblockerat(228.092318097);
    
    wet = wah_ctrl.wet_dry;
    dry = 1 - wet;

    Wah1 = (x : an.amp_follower_ud(0.01,0.1) : min(0.98) : max(0.03) : Inverted(1)): si.smooth(s);
    
    Wah2 = wah_ctrl.wah : max(0.03)  : LogPot(5) :  si.smooth(s);
    
    sl = wah_ctrl.mode;

    Wah3 = (os.oscs(freq) + 1) / 2 : min(1) : max(0.03) with {
        freq = wah_ctrl.freq;
    }; 

    Wah = select3(sl, Wah2, Wah1, Wah3);
    
    b0 = Wah*(Wah*pow(fs,2)*(fs*(1.25354929341128e-21*fs + 3.48240441721223e-17) + 5.13677938435808e-14) + fs*(fs*(fs*(-1.25190991353587e-21*fs - 3.48523283463119e-17) - 5.2316993137229e-14) - 1.41321715016552e-12)) + fs*(fs*(fs*(-7.56083860086155e-21*fs - 2.50316072026991e-16) - 3.73895528534631e-13) - 2.00079255014785e-12);

    b1 = Wah*(Wah*pow(fs,3)*(-5.01419717364513e-21*fs - 6.96480883442447e-17) + fs*(pow(fs,2)*(5.00763965414349e-21*fs + 6.97046566926238e-17) - 2.82643430033104e-12)) + fs*(pow(fs,2)*(3.02433544034462e-20*fs + 5.00632144053981e-16) - 4.0015851002957e-12);

    b2 = Wah*(Wah*pow(fs,2)*(7.52129576046769e-21*pow(fs,2) - 1.02735587687162e-13) + pow(fs,2)*(-7.51145948121523e-21*pow(fs,2) + 1.04633986274458e-13)) + pow(fs,2)*(-4.53650316051693e-20*pow(fs,2) + 7.47791057069262e-13);

    b3 = Wah*(Wah*pow(fs,3)*(-5.01419717364513e-21*fs + 6.96480883442447e-17) + fs*(pow(fs,2)*(5.00763965414349e-21*fs - 6.97046566926238e-17) + 2.82643430033104e-12)) + fs*(pow(fs,2)*(3.02433544034462e-20*fs - 5.00632144053981e-16) + 4.0015851002957e-12);

    b4 = Wah*(Wah*pow(fs,2)*(fs*(1.25354929341128e-21*fs - 3.48240441721223e-17) + 5.13677938435808e-14) + fs*(fs*(fs*(-1.25190991353587e-21*fs + 3.48523283463119e-17) - 5.2316993137229e-14) + 1.41321715016552e-12)) + fs*(fs*(fs*(-7.56083860086155e-21*fs + 2.50316072026991e-16) - 3.73895528534631e-13) + 2.00079255014785e-12);

    a0 = Wah*(Wah*pow(fs,2)*(fs*(-4.43653850017937e-20*fs - 6.36752117258257e-18) - 6.90511452608771e-14) + fs*(fs*(fs*(2.96437047678913e-19*fs + 2.2065454697261e-17) + 5.22620199701727e-14) + 1.9616802630931e-12)) + fs*(fs*(fs*(5.00642970027606e-20*fs + 3.44255097160751e-17) + 6.23836917215568e-13) + 1.48605150842693e-11) + 5.57295529287812e-11;

    a1 = Wah*(Wah*pow(fs,3)*(1.77461540007175e-19*fs + 1.27350423451651e-17) + fs*(pow(fs,2)*(-1.18574819071565e-18*fs - 4.4130909394522e-17) + 3.9233605261862e-12)) + fs*(pow(fs,2)*(-2.00257188011043e-19*fs - 6.88510194321502e-17) + 2.97210301685387e-11) + 2.22918211715125e-10;

    a2 = Wah*(Wah*pow(fs,2)*(-2.66192310010762e-19*pow(fs,2) + 1.38102290521754e-13) + pow(fs,2)*(1.77862228607348e-18*pow(fs,2) - 1.04524039940345e-13)) + pow(fs,2)*(3.00385782016564e-19*pow(fs,2) - 1.24767383443114e-12) + 3.34377317572687e-10;

    a3 = Wah*(Wah*pow(fs,3)*(1.77461540007175e-19*fs - 1.27350423451651e-17) + fs*(pow(fs,2)*(-1.18574819071565e-18*fs + 4.4130909394522e-17) - 3.9233605261862e-12)) + fs*(pow(fs,2)*(-2.00257188011043e-19*fs + 6.88510194321502e-17) - 2.97210301685387e-11) + 2.22918211715125e-10;

    a4 = Wah*(Wah*pow(fs,2)*(fs*(-4.43653850017937e-20*fs + 6.36752117258257e-18) - 6.90511452608771e-14) + fs*(fs*(fs*(2.96437047678913e-19*fs - 2.2065454697261e-17) + 5.22620199701727e-14) - 1.9616802630931e-12)) + fs*(fs*(fs*(5.00642970027606e-20*fs - 3.44255097160751e-17) + 6.23836917215568e-13) - 1.48605150842693e-11) + 5.57295529287812e-11;
};
