// generated automatically
// DO NOT MODIFY!
declare id "colbwah";
declare name "ColorSound Bass Wah";
declare category "Guitar Effects";
declare shortname "ColorSound Bass Wah";
declare description "ColorSound Bass Wah";

import("stdfaust.lib");
import("guitarix.lib");

process(x) = x : _<:*(dry),(*(wet) : pre : fi.iir((b0/a0,b1/a0,b2/a0,b3/a0,b4/a0),(a1/a0,a2/a0,a3/a0,a4/a0))):>_ with {
    LogPot(a, x) = ba.if(a, (exp(a * x) - 1) / (exp(a) - 1), x);
    Inverted(b, x) = ba.if(b, 1 - x, x);
    s = 0.993;
    fs = float(ma.SR);
    wet = wah_ctrl.wet_dry;
    dry = 1 - wet;
    pre = fi.dcblockerat(157.14639273);

    Wah1 = (x : an.amp_follower_ud(0.01,0.1) : min(1) : max(0.02) );

    Wah2 = wah_ctrl.wah : max(0.01) : Inverted(1) : LogPot(5) : si.smooth(s);
 
    sl = wah_ctrl.mode;

    Wah3 = (os.oscs(freq) + 1) / 2 : min(0.98) : max(0.02) : Inverted(1) with {
        freq = wah_ctrl.freq;
    }; 

    Wah = select3(sl, Wah2, Wah1, Wah3);
    
    b0 = Wah*(Wah*pow(fs,2)*(fs*(8.31690116887645e-22*fs + 3.20379811195304e-18) + 4.28499923433696e-15) + fs*(fs*(fs*(-8.23016292634919e-22*fs - 3.18413428804882e-18) - 4.30254138569803e-15) - 9.2036968791553e-14)) + fs*(fs*(fs*(-2.6706830774037e-21*fs - 1.27578229328233e-17) - 1.93436893661132e-14) - 1.00293349888753e-13);

    b1 = Wah*(Wah*pow(fs,3)*(-3.32676046755058e-21*fs - 6.40759622390608e-18) + fs*(pow(fs,2)*(3.29206517053968e-21*fs + 6.36826857609764e-18) - 1.84073937583106e-13)) + fs*(pow(fs,2)*(1.06827323096148e-20*fs + 2.55156458656466e-17) - 2.00586699777507e-13);

    b2 = Wah*(Wah*pow(fs,2)*(4.99014070132587e-21*pow(fs,2) - 8.56999846867392e-15) + pow(fs,2)*(-4.93809775580952e-21*pow(fs,2) + 8.60508277139606e-15)) + pow(fs,2)*(-1.60240984644222e-20*pow(fs,2) + 3.86873787322263e-14);

    b3 = Wah*(Wah*pow(fs,3)*(-3.32676046755058e-21*fs + 6.40759622390608e-18) + fs*(pow(fs,2)*(3.29206517053968e-21*fs - 6.36826857609764e-18) + 1.84073937583106e-13)) + fs*(pow(fs,2)*(1.06827323096148e-20*fs - 2.55156458656466e-17) + 2.00586699777507e-13);

    b4 = Wah*(Wah*pow(fs,2)*(fs*(8.31690116887645e-22*fs - 3.20379811195304e-18) + 4.28499923433696e-15) + fs*(fs*(fs*(-8.23016292634919e-22*fs + 3.18413428804882e-18) - 4.30254138569803e-15) + 9.2036968791553e-14)) + fs*(fs*(fs*(-2.6706830774037e-21*fs + 1.27578229328233e-17) - 1.93436893661132e-14) + 1.00293349888753e-13);

    a0 = Wah*(Wah*fs*(fs*(fs*(-6.97503428259418e-20*fs - 5.39620091780675e-18) - 3.42307552972106e-15) - 3.4676044717882e-14) + fs*(fs*(fs*(3.97898188862218e-19*fs + 2.67097118338883e-17) + 2.93048706029115e-15) + 1.04378397231604e-13)) + fs*(fs*(fs*(6.5528601067591e-21*fs + 2.74563396261683e-18) + 1.8780340503575e-14) + 5.83881532956283e-13) + 2.41228015122866e-12;

    a1 = Wah*(Wah*fs*(pow(fs,2)*(2.79001371303767e-19*fs + 1.07924018356135e-17) - 6.9352089435764e-14) + fs*(pow(fs,2)*(-1.59159275544887e-18*fs - 5.34194236677766e-17) + 2.08756794463207e-13)) + fs*(pow(fs,2)*(-2.62114404270364e-20*fs - 5.49126792523366e-18) + 1.16776306591257e-12) + 9.64912060491465e-12;

    a2 = Wah*(Wah*pow(fs,2)*(-4.18502056955651e-19*pow(fs,2) + 6.84615105944212e-15) + pow(fs,2)*(2.38738913317331e-18*pow(fs,2) - 5.8609741205823e-15)) + pow(fs,2)*(3.93171606405546e-20*pow(fs,2) - 3.75606810071501e-14) + 1.4473680907372e-11;

    a3 = Wah*(Wah*fs*(pow(fs,2)*(2.79001371303767e-19*fs - 1.07924018356135e-17) + 6.9352089435764e-14) + fs*(pow(fs,2)*(-1.59159275544887e-18*fs + 5.34194236677766e-17) - 2.08756794463207e-13)) + fs*(pow(fs,2)*(-2.62114404270364e-20*fs + 5.49126792523366e-18) - 1.16776306591257e-12) + 9.64912060491465e-12;

    a4 = Wah*(Wah*fs*(fs*(fs*(-6.97503428259418e-20*fs + 5.39620091780675e-18) - 3.42307552972106e-15) + 3.4676044717882e-14) + fs*(fs*(fs*(3.97898188862218e-19*fs - 2.67097118338883e-17) + 2.93048706029115e-15) - 1.04378397231604e-13)) + fs*(fs*(fs*(6.5528601067591e-21*fs - 2.74563396261683e-18) + 1.8780340503575e-14) - 5.83881532956283e-13) + 2.41228015122866e-12;
};
