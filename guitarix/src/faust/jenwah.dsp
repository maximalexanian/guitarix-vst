// generated automatically
// DO NOT MODIFY!
declare id "jenwah";
declare name "Jen Wah";
declare category "Guitar Effects";
declare shortname "Jen Wah";
declare description "Jen Wah";

import("stdfaust.lib");
import("guitarix.lib");

process(x) = x : _<:*(dry),(*(wet) : pre : fi.iir((b0/a0,b1/a0,b2/a0,b3/a0,b4/a0),(a1/a0,a2/a0,a3/a0,a4/a0))):>_ with {
    LogPot(a, x) = ba.if(a, (exp(a * x) - 1) / (exp(a) - 1), x);
    Inverted(b, x) = ba.if(b, 1 - x, x);
    s = 0.993;
    fs = float(ma.SR);
    pre = fi.dcblockerat(228.220182634);

    wet = wah_ctrl.wet_dry;
    dry = 1 - wet;

    Wah1 = (x : an.amp_follower_ud(0.01,0.1) : min(0.99) : max(0.1)): si.smooth(s);
    
    Wah2 = wah_ctrl.wah : Inverted(1) : LogPot(5) :  si.smooth(s);
    
    sl = wah_ctrl.mode;

    Wah3 = (os.oscs(freq) + 1) / 2 : min(0.98) : max(0.01) : Inverted(1) with {
        freq = wah_ctrl.freq;
    }; 

    Wah = select3(sl, Wah2, Wah1, Wah3);
    
    b0 = Wah*(Wah*pow(fs,2)*(fs*(4.26313918949843e-21*fs + 6.7438235280676e-17) + 9.21166476483994e-14) + fs*(fs*(fs*(-4.24968880185418e-21*fs - 6.74722090896416e-17) - 9.33056295237144e-14) - 1.7091597982174e-12)) + fs*(fs*(fs*(-7.44753937081794e-21*fs - 2.45894566379345e-16) - 3.53469573143013e-13) - 2.09356017382726e-14);

    b1 = Wah*(Wah*pow(fs,3)*(-1.70525567579937e-20*fs - 1.34876470561352e-16) + fs*(pow(fs,2)*(1.69987552074167e-20*fs + 1.34944418179283e-16) - 3.41831959643481e-12)) + fs*(pow(fs,2)*(2.97901574832717e-20*fs + 4.9178913275869e-16) - 4.18712034765452e-14);

    b2 = Wah*(Wah*pow(fs,2)*(2.55788351369906e-20*pow(fs,2) - 1.84233295296799e-13) + pow(fs,2)*(-2.54981328111251e-20*pow(fs,2) + 1.86611259047429e-13)) + pow(fs,2)*(-4.46852362249076e-20*pow(fs,2) + 7.06939146286026e-13);

    b3 = Wah*(Wah*pow(fs,3)*(-1.70525567579937e-20*fs + 1.34876470561352e-16) + fs*(pow(fs,2)*(1.69987552074167e-20*fs - 1.34944418179283e-16) + 3.41831959643481e-12)) + fs*(pow(fs,2)*(2.97901574832717e-20*fs - 4.9178913275869e-16) + 4.18712034765452e-14);

    b4 = Wah*(Wah*pow(fs,2)*(fs*(4.26313918949843e-21*fs - 6.7438235280676e-17) + 9.21166476483994e-14) + fs*(fs*(fs*(-4.24968880185418e-21*fs + 6.74722090896416e-17) - 9.33056295237144e-14) + 1.7091597982174e-12)) + fs*(fs*(fs*(-7.44753937081794e-21*fs + 2.45894566379345e-16) - 3.53469573143013e-13) + 2.09356017382726e-14);

    a0 = Wah*(Wah*pow(fs,2)*(fs*(-6.99671191908366e-20*fs - 1.39394278118629e-17) - 1.21159485597039e-13) + fs*(fs*(fs*(3.85720103312511e-19*fs + 2.77707619975565e-17) + 1.05494945988648e-13) + 2.75362467265997e-12)) + fs*(fs*(fs*(1.18553561246751e-20*fs + 3.2569797714609e-17) + 5.79248390117011e-13) + 1.0981649358109e-11) + 6.25823789240903e-13;

    a1 = Wah*(Wah*pow(fs,3)*(2.79868476763347e-19*fs + 2.78788556237258e-17) + fs*(pow(fs,2)*(-1.54288041325004e-18*fs - 5.55415239951129e-17) + 5.50724934531995e-12)) + fs*(pow(fs,2)*(-4.74214244987003e-20*fs - 6.51395954292179e-17) + 2.19632987162179e-11) + 2.50329515696361e-12;

    a2 = Wah*(Wah*pow(fs,2)*(-4.1980271514502e-19*pow(fs,2) + 2.42318971194078e-13) + pow(fs,2)*(2.31432061987506e-18*pow(fs,2) - 2.10989891977295e-13)) + pow(fs,2)*(7.11321367480505e-20*pow(fs,2) - 1.15849678023402e-12) + 3.75494273544542e-12;

    a3 = Wah*(Wah*pow(fs,3)*(2.79868476763347e-19*fs - 2.78788556237258e-17) + fs*(pow(fs,2)*(-1.54288041325004e-18*fs + 5.55415239951129e-17) - 5.50724934531995e-12)) + fs*(pow(fs,2)*(-4.74214244987003e-20*fs + 6.51395954292179e-17) - 2.19632987162179e-11) + 2.50329515696361e-12;

    a4 = Wah*(Wah*pow(fs,2)*(fs*(-6.99671191908366e-20*fs + 1.39394278118629e-17) - 1.21159485597039e-13) + fs*(fs*(fs*(3.85720103312511e-19*fs - 2.77707619975565e-17) + 1.05494945988648e-13) - 2.75362467265997e-12)) + fs*(fs*(fs*(1.18553561246751e-20*fs - 3.2569797714609e-17) + 5.79248390117011e-13) - 1.0981649358109e-11) + 6.25823789240903e-13;
};
