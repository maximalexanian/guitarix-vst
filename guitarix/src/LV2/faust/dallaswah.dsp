// generated automatically
// DO NOT MODIFY!
declare id "dallaswah";
declare name "Dallas Wah";
declare category "Guitar Effects";
declare shortname "Dallas  Wah";
declare description "Dallas Arbiter Wah";

import("stdfaust.lib");
import("guitarix.lib");

process(x) = x  : _<:*(dry),(*(wet) : pre : fi.iir((b0/a0,b1/a0,b2/a0,b3/a0,b4/a0),(a1/a0,a2/a0,a3/a0,a4/a0))):>_ with {
    LogPot(a, x) = ba.if(a, (exp(a * x) - 1) / (exp(a) - 1), x);
    Inverted(b, x) = ba.if(b, 1 - x, x);
    s = 0.993;
    fs = float(ma.SR);
    pre = fi.dcblockerat(583.714419367);
    
    wet = wah_ctrl.wet_dry;
    dry = 1 - wet;

    Wah1 = (x : an.amp_follower_ud(0.01,0.1) : min(1) : max(0.02) ) : si.smooth(s);

    Wah2 = wah_ctrl.wah : max(0.01) : Inverted(1) : LogPot(5) : si.smooth(s);
 
    sl = wah_ctrl.mode;

    Wah3 = (os.oscs(freq) + 1) / 2 : min(0.98) : max(0.02) : Inverted(1) with {
        freq = wah_ctrl.freq;
    }; 

    Wah = select3(sl, Wah2, Wah1, Wah3);
    
    b0 = Wah*(Wah*fs*(fs*(fs*(2.83510090714092e-21*fs + 1.04896968320146e-16) + 1.59534818623044e-13) - 1.53357283072645e-26) + fs*(fs*(fs*(-2.32347860461171e-21*fs - 8.64108311643329e-17) - 1.33575525905195e-13) - 3.41675778537176e-12)) + fs*(fs*(fs*(-7.07917432005204e-21*fs - 5.52389028989215e-16) - 8.63117119019868e-13) - 5.62135356398181e-12);

    b1 = Wah*(Wah*fs*(pow(fs,2)*(-1.13404036285637e-20*fs - 2.09793936640293e-16) - 3.06714566145289e-26) + fs*(pow(fs,2)*(9.29391441844685e-21*fs + 1.72821662328666e-16) - 6.83351557074351e-12)) + fs*(pow(fs,2)*(2.83166972802082e-20*fs + 1.10477805797843e-15) - 1.12427071279636e-11);

    b2 = Wah*(Wah*pow(fs,2)*(1.70106054428455e-20*pow(fs,2) - 3.19069637246088e-13) + pow(fs,2)*(-1.39408716276703e-20*pow(fs,2) + 2.6715105181039e-13)) + pow(fs,2)*(-4.24750459203123e-20*pow(fs,2) + 1.72623423803974e-12);

    b3 = Wah*(Wah*fs*(pow(fs,2)*(-1.13404036285637e-20*fs + 2.09793936640293e-16) + 3.06714566145289e-26) + fs*(pow(fs,2)*(9.29391441844685e-21*fs - 1.72821662328666e-16) + 6.83351557074351e-12)) + fs*(pow(fs,2)*(2.83166972802082e-20*fs - 1.10477805797843e-15) + 1.12427071279636e-11);

    b4 = Wah*(Wah*fs*(fs*(fs*(2.83510090714092e-21*fs - 1.04896968320146e-16) + 1.59534818623044e-13) + 1.53357283072645e-26) + fs*(fs*(fs*(-2.32347860461171e-21*fs + 8.64108311643329e-17) - 1.33575525905195e-13) + 3.41675778537176e-12)) + fs*(fs*(fs*(-7.07917432005204e-21*fs + 5.52389028989215e-16) - 8.63117119019868e-13) + 5.62135356398181e-12);

    a0 = Wah*(Wah*fs*(fs*(fs*(-4.47972527031659e-20*fs - 1.0922674147551e-17) - 2.09610231217262e-13) + 2.01493666656321e-26) + fs*(fs*(fs*(2.74906060407121e-19*fs + 2.45407810123387e-17) + 1.4198849343527e-13) + 5.60455163682517e-12) - 5.38753119401928e-25) + fs*(fs*(fs*(6.05097478328861e-20*fs + 3.86741226880994e-17) + 1.39111781189056e-12) + 3.46679367777423e-11) + 1.49854321840248e-10;

    a1 = Wah*(Wah*fs*(pow(fs,2)*(1.79189010812664e-19*fs + 2.18453482951021e-17) + 4.02987333312642e-26) + fs*(pow(fs,2)*(-1.09962424162848e-18*fs - 4.90815620246775e-17) + 1.12091032736503e-11) - 2.15501247760771e-24) + fs*(pow(fs,2)*(-2.42038991331544e-19*fs - 7.73482453761989e-17) + 6.93358735554846e-11) + 5.99417287360993e-10;

    a2 = Wah*(Wah*pow(fs,2)*(-2.68783516218996e-19*pow(fs,2) + 4.19220462434524e-13) + pow(fs,2)*(1.64943636244273e-18*pow(fs,2) - 2.8397698687054e-13) - 3.23251871641157e-24) + pow(fs,2)*(3.63058486997317e-19*pow(fs,2) - 2.78223562378113e-12) + 8.99125931041489e-10;

    a3 = Wah*(Wah*fs*(pow(fs,2)*(1.79189010812664e-19*fs - 2.18453482951021e-17) - 4.02987333312642e-26) + fs*(pow(fs,2)*(-1.09962424162848e-18*fs + 4.90815620246775e-17) - 1.12091032736503e-11) - 2.15501247760771e-24) + fs*(pow(fs,2)*(-2.42038991331544e-19*fs + 7.73482453761989e-17) - 6.93358735554846e-11) + 5.99417287360993e-10;

    a4 = Wah*(Wah*fs*(fs*(fs*(-4.47972527031659e-20*fs + 1.0922674147551e-17) - 2.09610231217262e-13) - 2.01493666656321e-26) + fs*(fs*(fs*(2.74906060407121e-19*fs - 2.45407810123387e-17) + 1.4198849343527e-13) - 5.60455163682517e-12) - 5.38753119401928e-25) + fs*(fs*(fs*(6.05097478328861e-20*fs - 3.86741226880994e-17) + 1.39111781189056e-12) - 3.46679367777423e-11) + 1.49854321840248e-10;
};
